--------------------------------------------------------------------------------------------------------------------------------
--	
--	Script name :	0015_hg_test_nr_lance_tout.sql
--	-------------
--	
--	Purpose :		Les fichiers <sequence>_<user>_lance_tout.sql sont utilisés pour déployer des évolutions ou des
--	---------		corrections dans une base de données cible !
--					
--					Lors d'un déploiement, la personne en charge (le DBA pour l'environnement de PROD) exécute tous les
--					<sequence>_<user>_lance_tout.sql dans l'odre du numéro de séquence <sequence> indiqué dans le nom
--					des scripts.
--					
--					Pour l'instant encore, mais plus pour longtemps (je l'espère /* PSR le 01/10/2019 */), chacun de ces
--					scripts est exécuté avec l'utilisateur Oracle indiqué par <user> dans le nom du scripts.
--					
--	Notes :			
--	-------			
--					
--	Remarks :		1./ S'il devait falloir utiliser le caractère '&' dans des scripts, il faudrait :
--	---------			* Soit faire une SET DEFINE OFF puis ON, dans le fichier en question
--						* Soit utiliser un caractère d'echappement et remplacer toutes les
--						occurences de '&' par '<caractère d'échappement>&'.
--						Par exemple, on peut définir le caractère d'échappement comme étant le point d'exclamation '!' avec
--						la commande SQL*PLUS : SET ESACPE !
--						Et remplacer toutes les occurences de '&' par '!&' dans les scripts concernés.
--	
--	History
--	-------
--	DD.MM.YYYY	Author       	Comment
--	----------	-------------	--------------------------------------------------------------------------------
--	23.12.2019	XXX_Auteur   	Génération du script à partir du template "start_automate.template".
--	
--------------------------------------------------------------------------------------------------------------------------------
@conf
@spool_name "0015_hg_test_nr_lance_tout"

-- Base DUNIQUE user ANIS
--------------------------------------------------------------------------------------------------------------------------------
@log "****************************************** DEBUT ******************************************"

@log "A lancer sur HG_DEV_DEPLOY@DUNIQUE"
Select Sys_Context('USERENV', 'DB_UNIQUE_NAME') As "instance", Sys_Context('USERENV', 'CURRENT_USER') As "user" From SYS.DUAL;

--------------------------------------------------------------------------------------------------------------------------------
@log "Démarrage session ADMINISTRA ..."
--------------------------------------------------------------------------------------------------------------------------------
Execute Session_Manager.start_Session('ADMINISTRA', Null, 'Mep mensuelle mois 2022 / Projet xxxxxx');

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create Tables ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Tables/table_name.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Alter Tables ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./alter_table_script_name.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create Indexes ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Index/index_name.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create Types ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Types/type_header_name.tys"
--@lance "./../../DUNIQUE/Anis/Types/type_body_name.tyb"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create Sequences ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Sequences/sequence_name.sql"

--------------------------------------------------------------------------------------------------------------------------------
@log "Grant Objects ..."
--------------------------------------------------------------------------------------------------------------------------------		
@lance "./grant_utplsql_owner.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Package Specification ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Package/package_body_header.pks"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Procedure ..."
--------------------------------------------------------------------------------------------------------------------------------	
--@lance "./../../DUNIQUE/Anis/Procedures/procedure_name.prc"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Functions ..."
--------------------------------------------------------------------------------------------------------------------------------	
--@lance "./../../DUNIQUE/Anis/Fonctions/function_name.fnc"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Package Body ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Package/package_body_name.pkb"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Materialized View Logs ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Materialized_view_logs/materialized_view_log_name.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Materialized Views ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Materialized_views/materialized_view_name.vw"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Views ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Views/view_name.vw"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Create / Replace Triggers ..."
--------------------------------------------------------------------------------------------------------------------------------
--@lance "./../../DUNIQUE/Anis/Triggers/trigger_name.trg"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Sql scripts ..."
--------------------------------------------------------------------------------------------------------------------------------	
--@lance "./sql_script.sql"

--------------------------------------------------------------------------------------------------------------------------------
--@log "Update Table Data ..."
--------------------------------------------------------------------------------------------------------------------------------	
--@lance "./update_script.sql"
	
--------------------------------------------------------------------------------------------------------------------------------
@log "Recompilation des invalides ..."
--------------------------------------------------------------------------------------------------------------------------------
Execute recompiler_Objets_Invalides();
	
--------------------------------------------------------------------------------------------------------------------------------
@log "Fin de session ADMINISTRA ..."
--------------------------------------------------------------------------------------------------------------------------------
Execute Session_Manager.stop_Session;
	
--------------------------------------------------------------------------------------------------------------------------------
@log "************************************* Fin script ANIS *************************************"
--------------------------------------------------------------------------------------------------------------------------------

spool off
